<!-- omit in toc -->
# Modane CO2 Watcher

![ã‚‚ã ã­ã¡ã‚ƒã‚“æ™‚è¨ˆã®å†™çœŸ](images/co2_watcher.jpg)

## 1. æ¦‚è¦

Raspberry Pi ã§å‹•ä½œã™ã‚‹ã‚‚ã ã­ã¡ã‚ƒã‚“ã®äºŒé…¸åŒ–ç‚­ç´ æ¿ƒåº¦è¨ˆã§ã™ğŸŒ¸  
C è¨€èªã¨ãƒ©ã‚ºãƒ‘ã‚¤ã®ç·´ç¿’ã§åˆ¶ä½œã—ã¾ã—ãŸã€‚

- å‘¨è¾ºã® CO2 æ¿ƒåº¦ã‚’10åˆ†æ¯ã«å–å¾—ã—ã€ã‚°ãƒ©ãƒ•ã¨ã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚
  - ã‚°ãƒ©ãƒ•ã¯ 20æ™‚é–“å‰ã¾ã§ã€10æ™‚é–“å‰ã¾ã§ã€3æ™‚é–“å‰ã¾ã§ ã®3ã¤ã®è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚
  - å–å¾—ã—ãŸ CO2 æ¿ƒåº¦ã¯ logs ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¸è“„ç©ã•ã‚Œã¾ã™ã€‚
- ç¾åœ¨ã®æ—¥æ™‚ã‚„å¤©æ°—ã‚’ä¸€å®šé–“éš”æ¯ã«è¡¨ç¤ºã—ã¾ã™ã€‚
  - å¤©æ°—ã‚’å–å¾—ã™ã‚‹å ´æ‰€ã¯ç’°å¢ƒå¤‰æ•°ã§æŒ‡å®šã§ãã¾ã™ã€‚
- ã‚‚ã ã­ã¡ã‚ƒã‚“ã®è¡¨æƒ…ãŒã‚³ãƒ­ã‚³ãƒ­å¤‰ã‚ã‚Šã¾ã™ã€‚
- ã‚·ã‚§ãƒ«ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å¹…ã«å¿œã˜ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã«æç”»ã—ã¾ã™ã€‚

## 2. ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢

- Raspberry Pi 4 Model B
- MH-Z19B
- ELECROW RC050S

## 3. ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢

### 3.1. OS

Raspberry Pi OS (32-bit)

### 3.2. è¨€èª

- C
  - ncurses ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- Python
  - [mh-z19](https://github.com/UedaTakeyuki/mh-z19) ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

### 3.3. ãã®ä»–

- LXTerminal ä¸Šã§å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚
- ãƒ•ã‚©ãƒ³ãƒˆã¯ [HackGenNerd Console](https://github.com/yuru7/HackGen) ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

## 4. ç’°å¢ƒæ§‹ç¯‰

### 4.1. ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®æ§‹ç¯‰

å…ˆã« [5.1. CO2 æ¿ƒåº¦ã®æ¸¬å®š](#51-co2-æ¿ƒåº¦ã®æ¸¬å®š) ã‚’å‚è€ƒã«ã€MH-Z19B ã‚»ãƒ³ã‚µãƒ¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’è¡Œã„ã¾ã™ã€‚

### 4.2. ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ§‹ç¯‰ãƒ»å®Ÿè¡Œ

ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’é †ã«å®Ÿè¡Œã—ã¾ã™ã€‚

```shell
> git clone https://github.com/kenkenpa198/ModaClock.git # ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
> export WTTR_LOCALE="Tokyo"                             # å¤©æ°—è¡¨ç¤ºç”¨ã®ãƒ­ã‚±ãƒ¼ãƒ«è¨­å®š
> sudo apt install libncurses5-dev                       # curses ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
> sudo pip3 install mh_z19                               # mh_z19 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
> gcc ModaClock.c -lncursesw -o ModaClock.out            # ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
> ./ModaClock.out                                        # å®Ÿè¡Œ
```

WTTR_LOCALE ç’°å¢ƒå¤‰æ•°ã¯ .bashrc ãªã©ã«è¨˜è¿°ã—ã¦æ°¸ç¶šåŒ–ã—ã¦ãŠã„ãŸæ–¹ãŒã‚ˆã„ã§ã™ã€‚  
ãŠå¥½ã¿ã§ã‚·ã‚§ãƒ«ã®ãƒ•ã‚©ãƒ³ãƒˆã®èª¿æ•´ã‚„ autostart ç­‰ã®è¨­å®šã‚‚ã€‚

## 5. æ—¢çŸ¥ã®ä¸å…·åˆ

- Raspberry Pi ã®ç’°å¢ƒã§ã®ã¿ã€å¤©æ°—ã®åˆå›å–å¾—å¾Œã«è¡¨ç¤ºãŒã†ã¾ãã§ããªã„äº‹è±¡ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
  - æ¬¡ã®å–å¾—æ™‚ï¼ˆ30åˆ†æ¯ï¼‰ã«æ­£å¸¸ã«è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

## 6. ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ

ä»¥ä¸‹ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã•ã›ã¦ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ã€‚

- [UedaTakeyuki/mh-z19](https://github.com/UedaTakeyuki/mh-z19)
- [chubin/wttr.in](https://github.com/chubin/wttr.in)
- [yuru7/HackGen)](https://github.com/yuru7/HackGen)

## 7. å‚è€ƒã‚µã‚¤ãƒˆ

### 7.1. Raspberry Pi

#### 7.1.1. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

- [ãƒ©ã‚ºãƒ‘ã‚¤ã§éŠã¼ã†ï¼ - YouTube](https://www.youtube.com/playlist?list=PLZv220voQQ_OYkVoim13CA91R_iLospsR)
- [Raspberry Pi4ã§ä½¿ãˆã‚‹ã‚¿ãƒƒãƒãƒ‘ãƒãƒ«ä»˜ã5ã‚¤ãƒ³ãƒãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã‚’è²·ã£ã¦ã¿ãŸï¼ â€“ ã™ã„ãƒ©ãƒœ](https://sui-lab.info/archives/3222)
- [ã€ãƒ©ã‚ºãƒ‘ã‚¤ã€‘Raspberry Piã‚’ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ãªã—ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ - è»Šè¼ªæ—¥è¨˜](https://bowmiow.net/garage/raspi-first/#toc12)

#### 7.1.2. è¨­å®š

- [ãƒ©ã‚ºãƒ™ãƒªãƒ¼ãƒ‘ã‚¤ã§ãƒ•ã‚©ãƒ³ãƒˆã‚’ç°¡å˜ã«è¿½åŠ å‰Šé™¤ã™ã‚‹ | ã‘ã„ãã‚…ã‚“ ãƒ½(^â—‡^*)/â™ª ã§ãŠã˜ã‚ƒã‚‹](https://ameblo.jp/anima-ameblo/entry-12398046009.html)
- [ãƒ©ã‚ºãƒ‘ã‚¤ã‚’èµ·å‹•ã—ãŸã‚‰ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«é–‹ã„ã¦ã‚·ã‚§ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³• - Qiita](https://qiita.com/tonosamart/items/f59daa481f90c85a8a99)
- [é›»æºå…¥ã‚ŒãŸã‚‰RaspberryPiã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãŒGUIã§å…¨ç”»é¢è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ - çŸ¥è¦‹ï¼ˆãƒ»ãƒ»ï¼‰ï¼](https://amiq11.hatenablog.com/entry/2018/09/12/230201)
- [vim :: readonly ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ sudo ã§å¼·åˆ¶çš„ã«ä¿å­˜ã™ã‚‹ [Tipsã¨ã„ã†ã‹ãƒ¡ãƒ¢]](https://tm.root-n.com/unix:command:vim:readlonly_write)
- [Raspberry Piã®èµ·å‹•æ™‚ã«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãŒç«‹ã¡ä¸ŠãŒã‚Šã€ã€ŒHello worldã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã‚ˆã†ã¨æ€ã„ã¾ã—ãŸãŒä¸Šæ‰‹ãã„ãã¾ã›ã‚“.](https://teratail.com/questions/334030)
- [RasiPiã§ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è‡ªå‹•èµ·å‹•ã—ã¦ã‚­ã‚ªã‚¹ã‚¯ç«¯æœ«ã«ã™ã‚‹æ–¹æ³• | æ˜ åƒã¨ãã®å‘¨è¾º](https://www.kalium.net/image/2021/03/11/rasipiã§ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è‡ªå‹•èµ·å‹•ã—ã¦ã‚­ã‚ªã‚¹ã‚¯ç«¯æœ«ã«ã™ã‚‹/)

#### 7.1.3. CO2 æ¿ƒåº¦ã®æ¸¬å®š

- [Raspberry Pi 4ã¨MH-Z19Bã§äºŒé…¸åŒ–ç‚­ç´ æ¿ƒåº¦ã‚’è¨ˆæ¸¬ã—ã¦ã¿ãŸ | DevelopersIO](https://dev.classmethod.jp/articles/raspberry-pi-4-b-mh-z19b-co2/)
- [ã€Pythonã€‘Raspberry Pi + mh-z19ã§CO2æ¿ƒåº¦å–å¾—ã—ã¦ã¿ãŸ - BFTåå¤å±‹ TECH BLOG](https://bftnagoya.hateblo.jp/entry/2021/08/25/120844)

### 7.2. Cè¨€èª

#### 7.2.1. ç”»é¢æç”»

- [curses ã«ã‚ˆã‚‹ç«¯æœ«åˆ¶å¾¡](https://www.kushiro-ct.ac.jp/yanagawa/ex-2017/2-game/01.html)
- [cursesãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è¶…ã¦ãã¨ãƒ¼è§£èª¬](https://www.kushiro-ct.ac.jp/yanagawa/pl2b-2018/curses/about.html)
- [[linux] cursesãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« --- undefined reference 'initscr'|Debugging as Usual](http://debuggingasusual.blogspot.com/2011/12/curses.html)
- [Cè¨€èªã§ã‚·ãƒ³ãƒ—ãƒ«ã™ãã‚‹ãƒ–ãƒ­ãƒƒã‚¯å´©ã—ã‚’æ›¸ã„ãŸ - Qiita](https://qiita.com/pokohide/items/a246045f3ccaf540a375)
- [æ–‡å­—åˆ—ã®é•·ã•ã®å–å¾—(Cè¨€èª) - è¶…åˆå¿ƒè€…å‘ã‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å…¥é–€](https://programming.pc-note.net/c/mojiretsu2.html)

#### 7.2.2. é…åˆ—æ“ä½œãªã©

- [Cè¨€èªã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã€€æ™‚è¨ˆã®ä½œã‚Šæ–¹1](http://www.orchid.co.jp/computer/cschool/clock1.html)
- [popenã§ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã‚’èª­ã¿è¾¼ã‚€ - Cè¨€èªå…¥é–€](https://kaworu.jpn.org/c/popenã§ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã‚’èª­ã¿è¾¼ã‚€)
- [Cè¨€èªã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚·ã‚§ãƒ«ã‚’å®Ÿè¡Œã—ãŸã„](https://teratail.com/questions/29960)
- [é…åˆ—ã‚’è‡ªç”±è‡ªåœ¨ã«ä½œã‚‹ - è‹¦ã—ã‚“ã§è¦šãˆã‚‹Cè¨€èª](https://9cguide.appspot.com/19-01.html)
- [Cè¨€èªã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ä¸€è¡Œãšã¤æ–‡å­—åˆ—ã‚’èª­ã¿è¾¼ã¿ã€å„è¡Œã”ã¨ã«é…åˆ—ã«æ ¼ç´ã™ã‚‹æ–¹æ³•](https://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q12145978347)
- [ã€Cè¨€èªã€‘æ–‡å­—åˆ—ã‚’é€£çµãƒ»çµåˆã™ã‚‹ã€strcatã®å±é™ºæ€§ã¨snprintfã®å®‰å…¨æ€§ã€‘ | MaryCore](https://marycore.jp/prog/c-lang/concat-c-string/#snprintfé–¢æ•°ã«ã‚ˆã‚‹æ–‡å­—åˆ—çµåˆ)
- [ã€Cè¨€èªã€‘sprintf é–¢æ•°ã¨ snprintf é–¢æ•°ï¼ˆãŠæ‰‹è»½ã«æ–‡å­—åˆ—ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°ï¼‰ | ã ãˆã†ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸](https://daeudaeu.com/c-sprintf/#sprintf-3)
- [ã€Cè¨€èªã€‘mallocé–¢æ•°ï¼ˆãƒ¡ãƒ¢ãƒªã®å‹•çš„ç¢ºä¿ï¼‰ã«ã¤ã„ã¦åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ | ã ãˆã†ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸](https://daeudaeu.com/c_malloc/)

### 7.3. å¤©æ°—æƒ…å ±ã®å–å¾—

- [curl ã§ wttr.in ã«å•ã„åˆã‚ã›ã¦ ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§å¤©æ°—äºˆå ±ã‚’ç¢ºèªã™ã‚‹ - ãƒ–ãƒ­ã‚°](https://gouf.hatenablog.com/entry/2018/06/29/174028)
- [å¤©æ°—ã‚’å‘Ÿãbotï½œã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä½œã‚‹ Twitter bot ä½œæˆå…¥é–€](https://zenn.dev/mattn/books/bb181f3f4731920f29a5/viewer/cc50c48272963c206d34)

### 7.4. ã‚¢ã‚¹ã‚­ãƒ¼ã‚¢ãƒ¼ãƒˆ

- [Pythonã¨OpenCVã§ç”»åƒã‚’ã‚¢ã‚¹ã‚­ãƒ¼ã‚¢ãƒ¼ãƒˆåŒ–ã—ã¦ã¿ã‚‹ï¼ˆãƒˆãƒ¬ãƒ¼ã‚¹AAã¸ã®é“ï¼‰ | ã­ã»ã‚Š.com](https://nehori.com/nikki/2021/04/04/post-27881/)
- [ã‚¢ã‚¹ã‚­ãƒ¼ã‚¢ãƒ¼ãƒˆ - Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%A2%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%A2%E3%83%BC%E3%83%88)
